@model School
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutSchoolNew.cshtml";
    string lat = Model.Latitude == null ? "null" : "lat";
    string lang = Context.Request.Cookies["lang"];
}

<button type="button" class="btn btn-primary mb-2" data-target="#exampleModal" data-toggle="modal">@Localization.GetTranslate("edit", lang).ToUpper()</button>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header card-header-primary">
                <h4 class="card-title">@Localization.GetTranslate("school_profile", lang).ToUpper()</h4>
            </div>
            <div class="card-body">
                <form method="post">

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("region", lang).ToUpper()</label>
                                <select class="custom-select" name="RegionId" id="Regions" disabled>
                                    <option selected value="@Model.RegionId">@Model.Region.name_uz</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("district", lang).ToUpper()</label>
                                <select class="custom-select" name="DistrictId" id="Districts" disabled>
                                    <option selected value="@Model.DistrictId">@Model.District.name_uz</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("school_type", lang).ToUpper()</label>
                                <select class="custom-select" name="TypeId" id="SchoolTypes" disabled>
                                    <option selected value="@Model.TypeId">@Model.SchoolType.NameUz</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_uz", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameUz" value="@Model.NameUz" readonly>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_uzk", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameUzk" value="@Model.NameUzk" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_ru", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameRu" value="@Model.NameRu" readonly>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_en", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameEn" value="@Model.NameEn" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("school_number", lang).ToUpper()</label>
                                <input type="number" class="form-control" name="Number" value="@Model.Number" readonly>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("school_builded_year", lang).ToUpper()</label>
                                <input type="number" class="form-control" name="BuildedYear" value="@Model.BuildedYear" readonly>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("director", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="Director" value="@Model.Director" readonly>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("phone_number", lang).ToUpper()</label>
                                <input type="tel" class="form-control" name="Phone" id="phone" value="@Model.Phone" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        @*<div class="col-12">
                                @if (Model.Latitude != null && Model.Latitude != "")
                                {
                                    <div id="mapholder" style="width: 100%; height: 400px">

                                    </div>
                                }
                            </div>*@
                        <div class="col-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("address", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="Address" id="address" value="@Model.Address" readonly />
                            </div>
                        </div>

                        <div class="col-12">
                            <p>@Localization.GetTranslate("last_updated_date", lang).ToUpper() <mark> @Model.UpdateDate </mark> </p>
                        </div>

                        <input type="hidden" class="form-control" name="Latitude" id="Latitude" value="@Model.Latitude" />
                        <input type="hidden" class="form-control" name="Longtitude" id="Longtitude" value="@Model.Longtitude" />

                    </div>

                    <div class="clearfix"></div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <form method="post" action="/SchoolProfile/EditProfile/">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">@Localization.GetTranslate("school_profile", lang).ToUpper() (@Localization.GetTranslate("Edit", lang).ToUpper())</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_uz", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameUz" value="@Model.NameUz">
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_uzk", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameUzk" value="@Model.NameUzk">
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_ru", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameRu" value="@Model.NameRu">
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("name_en", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="NameEn" value="@Model.NameEn">
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("school_number", lang).ToUpper()</label>
                                <input type="number" class="form-control" name="Number" value="@Model.Number">
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("school_builded_year", lang).ToUpper()</label>
                                <input type="number" class="form-control" name="BuildedYear" value="@Model.BuildedYear">
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("director", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="Director" value="@Model.Director">
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("phone_number", lang).ToUpper()</label>
                                <input type="tel" class="form-control" name="Phone" id="phone" value="@Model.Phone">
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="bmd-label-floating">@Localization.GetTranslate("address", lang).ToUpper()</label>
                                <input type="text" class="form-control" name="Address" id="address" value="@Model.Address" />
                            </div>
                        </div>

                        <input type="hidden" name="Id" value="@Model.Id" />
                        <input type="hidden" name="RegionId" value="@Model.RegionId" />
                        <input type="hidden" name="DistrictId" value="@Model.DistrictId" />
                        <input type="hidden" name="TypeId" value="@Model.TypeId" />
                        <input type="hidden" name="Latitude" value="@Model.Latitude" />
                        <input type="hidden" name="Longtitude" value="@Model.Longtitude" />
                    </div>
                </div>
                <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-dismiss="modal">@Localization.GetTranslate("back", lang).ToUpper()</button>
                        <button type="submit" class="btn btn-primary">@Localization.GetTranslate("save", lang).ToUpper()</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>

    $(function () {
        $("#phone").inputmask({ "mask": "+\\9\\98(99) 999-9999" });
        $("#exampleModal").appendTo('body');
    })

    @*$(document).ready(function () {
        var r = $('#Latitude').val();
        if (r != "") {
            ymaps.ready(init);

            function init() {
                var myMap = new ymaps.Map("mapholder", {
                    center: [@Model.Latitude, @Model.Longtitude],
                    zoom: 17,
                },
                {
                    suppressMapOpenBlock: true
                },
                {
                    searchControlProvider: 'yandex#search'
                });

                myPlacemark = createPlacemark([@Model.Latitude, @Model.Longtitude]);
                myMap.geoObjects.add(myPlacemark);
                myPlacemark.events.add(function () {
                    getAddress(myPlacemark.geometry.getCoordinates());
                });
                getAddress([@Model.Latitude, @Model.Longtitude]);

                function createPlacemark(coords) {
                    return new ymaps.Placemark(coords, {
                        iconCaption: 'поиск...'


                    }, {
                        preset: 'islands#blueDotIconWithCaption',
                        draggable: false
                    });
                }

                function getAddress(coords) {
                    myPlacemark.properties.set('iconCaption', 'поиск...');
                    ymaps.geocode(coords).then(function (res) {
                        var firstGeoObject = res.geoObjects.get(0);

                        myPlacemark.properties
                            .set({
                                iconCaption: [
                                    firstGeoObject.getLocalities().length ? firstGeoObject.getLocalities() : firstGeoObject.getAdministrativeAreas(),
                                    firstGeoObject.getThoroughfare() || firstGeoObject.getPremise()
                                ].filter(Boolean).join(', '),
                                balloonContent: firstGeoObject.getAddressLine()
                            });
                        document.getElementById("address").value = firstGeoObject.getAddressLine();
                        document.getElementById("Latitude").value = coords[0];
                        document.getElementById("Longtitude").value = coords[1];
                    });
                }
            }
        }
    });*@
</script>